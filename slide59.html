<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <link rel="stylesheet" href="assets/css/common.css">
  <link rel="stylesheet" href="assets/css/slide59.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PoliPay - Protótipo</title>
</head>
<body>
  <div class="container">
    <button class="back-button hidden" id="backButton" type="button" aria-label="Voltar">←</button>

    <!-- Tela 1: E-mail de cobrança -->
    <section class="screen active" id="screen1" aria-labelledby="t1">
      <div class="logo">

      </div>

      <div class="email-header">
        <div class="email-title">Seu link chegou!</div>
        <div class="email-subtitle">Pague seu seguro com segurança em poucos cliques</div>
        <div class="email-date">Segunda-feira, 19 de setembro de 2025 às 16:13</div>
      </div>

      <div class="payment-info">
        <div class="greeting">Olá, João da Silva,</div>
        <div class="payment-description">
          Para manter sua cobertura ativa, conclua o pagamento com segurança pelo link abaixo:
        </div>

        <div class="payment-details">
          <div class="detail-row"><span>Seguro</span><span>Patrimonial Rural</span></div>
          <div class="detail-row"><span>Apólice</span><span>APL123456/891011</span></div>
          <div class="detail-row"><span>Seguradoras</span><span>FF Seguros</span></div>
          <div class="detail-row"><span>Corretor</span><span>Nathan Camargo</span></div>
          <div class="detail-row"><span>Vencimento</span><span>14/10/2025</span></div>
          <div class="detail-row"><span>Total</span><span>R$ 1.200,00</span></div>
        </div>

        <button class="btn-primary" id="toPay">Clique aqui para pagar</button>
      </div>

      <div class="footer"><div class="footer-text">FairFax - © 2025 All Rights Reserved</div></div>
    </section>

    <!-- Tela 2: Seleção de método -->
    <section class="screen" id="screen2" aria-labelledby="t2">
      <div class="logo">
      </div>

      <div class="payment-layout" style="display:flex;gap:20px">
        <div style="flex:1">
          <h3 style="margin-bottom:20px;color:#333">Pagamento</h3>

          <div class="payment-methods">
            <div class="method-title">Método de pagamento</div>
            <div class="method-options">
              <label class="method-option" for="cartao">
                <input type="radio" name="payment" value="cartao" id="cartao" checked>
                Cartão
              </label>
              <label class="method-option" for="pix">
                <input type="radio" name="payment" value="pix" id="pix">
                Pix
              </label>
              <label class="method-option" for="boleto">
                <input type="radio" name="payment" value="boleto" id="boleto">
                Boleto
              </label>
            </div>
          </div>

          <div id="card-form" class="card-form">
            <div class="form-group">
              <label class="form-label" for="cc-number">Número do Cartão</label>
              <input id="cc-number" type="text" class="form-input" placeholder="1234 5678 9101 1121" maxlength="19" inputmode="numeric">
            </div>

            <div class="form-row">
              <div class="form-group">
                <label class="form-label" for="cc-exp">Data Expiração</label>
                <input id="cc-exp" type="text" class="form-input" placeholder="MM/AA" maxlength="5" inputmode="numeric">
              </div>
              <div class="form-group">
                <label class="form-label" for="cc-cvv">CVV</label>
                <input id="cc-cvv" type="text" class="form-input" placeholder="123" maxlength="3" inputmode="numeric">
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="installments">Parcelas</label>
              <select id="installments" class="installments-select">
                <option>1x de R$ 1.200,00 sem juros</option>
                <option>2x de R$ 600,00 sem juros</option>
                <option>3x de R$ 400,00 sem juros</option>
                <option>6x de R$ 215,50 com juros</option>
                <option>12x de R$ 115,75 com juros</option>
              </select>
            </div>
          </div>

          <button class="btn-primary" id="payButton">Pagar R$ 1.200,00</button>
          <div class="terms">Seus dados pessoais serão usados para processar seu pedido e para outros fins descritos em nossa política de privacidade.</div>
        </div>

        <aside class="payment-summary" aria-label="Resumo">
          <div class="summary-title">Dados do Seguro</div>
          <div class="detail-row"><span>Patrimonial Rural</span><span>R$ 1.200,00</span></div>
          <div style="font-size:12px;color:#999;margin-bottom:15px">APL123456/891011</div>
          <div class="detail-row"><span>Seguradora</span><span>FF Seguros</span></div>
          <div class="detail-row"><span>Corretor</span><span>Nathan Camargo</span></div>
          <div class="detail-row"><span><strong>Total</strong></span><span><strong>R$ 1.200,00</strong></span></div>

          <div class="logo" style="margin-top:20px">
 
          </div>
        </aside>
      </div>
    </section>

    <!-- Tela 3a: OTP Cartão -->
    <section class="screen" id="screen3a" aria-labelledby="t3a">
      <div class="logo">

      </div>

      <div class="payment-layout" style="display:flex;gap:20px">
        <div style="flex:1">
          <h3 style="margin-bottom:20px;color:#333">Pagamento</h3>

          <div class="payment-methods">
            <div class="method-title">Método de pagamento</div>
            <div class="method-options">
              <label class="method-option"><input type="radio" checked disabled> Cartão</label>
            </div>
          </div>

          <div class="otp-form">
            <div class="otp-description">Digite o código enviado pelo seu banco para confirmar sua transação</div>
            <div class="otp-inputs">
              <input type="text" class="otp-input" maxlength="1" inputmode="numeric">
              <input type="text" class="otp-input" maxlength="1" inputmode="numeric">
              <input type="text" class="otp-input" maxlength="1" inputmode="numeric">
              <input type="text" class="otp-input" maxlength="1" inputmode="numeric">
            </div>
          </div>

          <button class="btn-primary" id="confirmCard">Confirmar pagamento</button>
          <div class="terms">Seus dados pessoais serão usados para processar seu pedido.</div>
        </div>

        <aside class="payment-summary">
          <div class="summary-title">Dados do Seguro</div>
          <div class="detail-row"><span>Patrimonial Rural</span><span>R$ 1.200,00</span></div>
          <div style="font-size:12px;color:#999;margin-bottom:15px">APL123456/891011</div>
          <div class="detail-row"><span>Seguradora</span><span>FF Seguros</span></div>
          <div class="detail-row"><span>Corretor</span><span>Nathan Camargo</span></div>
          <div class="detail-row"><span><strong>Total</strong></span><span><strong>R$ 1.200,00</strong></span></div>
          <div class="logo" style="margin-top:20px">
            <div class="logo-dots"><div class="dot red"></div><div class="dot orange"></div><div class="dot yellow"></div><div class="dot green"></div></div>
            <div class="logo-text">PoliPay</div>
          </div>
        </aside>
      </div>
    </section>

    <!-- Tela 3b: PIX -->
    <section class="screen" id="screen3b" aria-labelledby="t3b">
      <div class="logo">

      </div>

      <div class="payment-layout" style="display:flex;gap:20px">
        <div style="flex:1">
          <h3 style="margin-bottom:20px;color:#333">Pagamento</h3>

          <div class="payment-methods">
            <div class="method-title">Método de pagamento</div>
            <div class="method-options">
              <label class="method-option"><input type="radio" checked disabled> Pix</label>
            </div>
          </div>

          <div class="qr-code">
            <div class="qr-image">
              <!-- QR fake simples -->
              <div style="width:180px;height:180px;background:url('data:image/svg+xml;charset=utf-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23fff%22/><g fill=%22%23000%22><rect x=%2210%22 y=%2210%22 width=%2230%22 height=%2230%22/><rect x=%2260%22 y=%2210%22 width=%2230%22 height=%2230%22/><rect x=%2210%22 y=%2260%22 width=%2230%22 height=%2230%22/><rect x=%2215%22 y=%2215%22 width=%2220%22 height=%2220%22 fill=%22%23fff%22/><rect x=%2265%22 y=%2215%22 width=%2220%22 height=%2220%22 fill=%22%23fff%22/><rect x=%2215%22 y=%2265%22 width=%2220%22 height=%2220%22 fill=%22%23fff%22/><rect x=%2220%22 y=%2220%22 width=%2210%22 height=%2210%22/><rect x=%2270%22 y=%2220%22 width=%2210%22 height=%2210%22/><rect x=%2220%22 y=%2270%22 width=%2210%22 height=%2210%22/><rect x=%2250%22 y=%2250%22 width=%2210%22 height=%2210%22/><rect x=%2245%22 y=%2255%22 width=%225%22 height=%225%22/><rect x=%2255%22 y=%2245%22 width=%225%22 height=%225%22/></g></svg>') center/contain no-repeat;"></div>
            </div>

            <div class="pix-code" id="pixPayload">
              00020101021226890014br.gov.bcb.pix2567qrpay.example.com/v2/76f94d0c-dc20-4b5d-85bb-b7bcd04a86d052040000530398654041.2005802BR5913Example Store6009Sao Paulo61080540900062290525FF Seguros Payment6304A1B2
            </div>

            <button class="copy-btn" id="copyPix">Copiar código PIX</button>

            <div class="pix-instructions">
              Você pode pagar através do QR Code:<br>
              1. Abra o app do seu banco e escolha PIX<br>
              2. Selecione “Ler QR Code”<br>
              3. Aponte para o código acima<br>
              4. Confira e confirme o pagamento
            </div>
          </div>
        </div>

        <aside class="payment-summary">
          <div class="summary-title">Dados do Seguro</div>
          <div class="detail-row"><span>Patrimonial Rural</span><span>R$ 1.200,00</span></div>
          <div style="font-size:12px;color:#999;margin-bottom:15px">APL123456/891011</div>
          <div class="detail-row"><span>Seguradora</span><span>FF Seguros</span></div>
          <div class="detail-row"><span>Corretor</span><span>Nathan Camargo</span></div>
          <div class="detail-row"><span><strong>Total</strong></span><span><strong>R$ 1.200,00</strong></span></div>
          <div class="logo" style="margin-top:20px">

          </div>
        </aside>
      </div>
    </section>

    <!-- Tela 3c: Boleto -->
    <section class="screen" id="screen3c" aria-labelledby="t3c">
      <div class="logo">

      </div>

      <div class="payment-layout" style="display:flex;gap:20px">
        <div style="flex:1">
          <h3 style="margin-bottom:20px;color:#333">Pagamento</h3>

          <div class="payment-methods">
            <div class="method-title">Método de pagamento</div>
            <div class="method-options">
              <label class="method-option"><input type="radio" checked disabled> Boleto</label>
            </div>
          </div>

          <div class="boleto-info">
            <div class="due-date"><strong>Vencimento</strong><br>Segunda-feira, 25 de Ago.</div>

            <div class="barcode">
              <div class="barcode-lines"></div>
              <div class="barcode-number" id="boletoLine">10490.00131 80200.006000 78560.003100 1 18560000120000</div>
            </div>

            <div class="boleto-buttons">
              <button class="btn-secondary" id="viewBoleto">Visualizar boleto</button>
              <button class="btn-secondary" id="copyBoleto">Copiar código do boleto</button>
            </div>

            <div class="boleto-instructions">
              <strong>Informações importantes:</strong><br><br>
              • Você pode pagar pelo internet banking, app do banco ou lotéricas.<br>
              • Use o código de barras acima ou gere o PDF para impressão.<br>
              • Em caso de atraso, podem incidir acréscimos conforme regras do emissor.
            </div>
          </div>
        </div>

        <aside class="payment-summary">
          <div class="summary-title">Dados do Seguro</div>
          <div class="detail-row"><span>Patrimonial Rural</span><span>R$ 1.200,00</span></div>
          <div style="font-size:12px;color:#999;margin-bottom:15px">APL123456/891011</div>
          <div class="detail-row"><span>Seguradora</span><span>FF Seguros</span></div>
          <div class="detail-row"><span>Corretor</span><span>Nathan Camargo</span></div>
          <div class="detail-row"><span><strong>Total</strong></span><span><strong>R$ 1.200,00</strong></span></div>
          <div class="logo" style="margin-top:20px">

          </div>
        </aside>
      </div>
    </section>
  </div>

  <div class="navigation">
    <a href="slide58.html" class="nav-btn">← Anterior</a>
    <div class="slide-counter">59 / 60</div>
    <a href="slide60.html" class="nav-btn">Próximo →</a>
  </div>

  <script>
    let currentScreen = '1';

    function showScreen(id){
      document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
      document.getElementById('screen'+id).classList.add('active');
      currentScreen = String(id);
      updateBackButton();
      focusFirstInput(id);
    }

    function updateBackButton(){
      const back = document.getElementById('backButton');
      if(currentScreen==='1'){ back.classList.add('hidden'); }
      else{ back.classList.remove('hidden'); }
    }

    function goBack(){
      if(currentScreen==='2'){ showScreen('1'); }
      else if(['3a','3b','3c'].includes(currentScreen)){ showScreen('2'); }
    }

    // Eventos iniciais
    document.getElementById('backButton').addEventListener('click', goBack);
    document.getElementById('toPay').addEventListener('click', ()=>showScreen('2'));

    // Alterna método e exibe formulário de cartão
    document.querySelectorAll('input[name="payment"]').forEach(r=>{
      r.addEventListener('change', updatePaymentMethod);
    });
    function updatePaymentMethod(){
      const sel = document.querySelector('input[name="payment"]:checked')?.value || 'cartao';
      const cardForm = document.getElementById('card-form');
      cardForm.style.display = sel==='cartao' ? 'block' : 'none';
    }

    // Processa pagamento e navega
    document.getElementById('payButton').addEventListener('click', ()=>{
      const sel = document.querySelector('input[name="payment"]:checked')?.value || 'cartao';
      if(sel==='cartao') showScreen('3a');
      if(sel==='pix')    showScreen('3b');
      if(sel==='boleto') showScreen('3c');
    });

    // OTP: apenas números e auto-avança
    function wireOtp(){
      const inputs = document.querySelectorAll('#screen3a .otp-input');
      inputs.forEach((inp,idx)=>{
        inp.addEventListener('input', e=>{
          e.target.value = e.target.value.replace(/\D/g,'').slice(0,1);
          if(e.target.value && idx<inputs.length-1){ inputs[idx+1].focus(); }
        });
        inp.addEventListener('keydown', e=>{
          if(e.key==='Backspace' && !e.target.value && idx>0){ inputs[idx-1].focus(); }
        });
      });
    }

    // Confirmar cartão
    document.getElementById('confirmCard').addEventListener('click', ()=>{
      alert('Pagamento com cartão confirmado.'); // placeholder
      showScreen('1');
    });

    // PIX: copiar payload
    document.getElementById('copyPix').addEventListener('click', async (ev)=>{
      const payload = document.getElementById('pixPayload').innerText.trim();
      try{
        await navigator.clipboard.writeText(payload);
        flashBtn(ev.currentTarget,'Código copiado!');
      }catch{
        legacyCopy(payload);
        flashBtn(ev.currentTarget,'Código copiado!');
      }
    });

    // Boleto: visualizar e copiar
    document.getElementById('viewBoleto').addEventListener('click', ()=>{
      alert('Abrir PDF do boleto (mock).');
    });
    document.getElementById('copyBoleto').addEventListener('click', async (ev)=>{
      const line = document.getElementById('boletoLine').innerText.trim();
      try{
        await navigator.clipboard.writeText(line);
        flashBtn(ev.currentTarget,'Linha digitável copiada!');
      }catch{
        legacyCopy(line);
        flashBtn(ev.currentTarget,'Linha digitável copiada!');
      }
    });

    function legacyCopy(text){
      const ta=document.createElement('textarea');
      ta.value=text; document.body.appendChild(ta);
      ta.select(); document.execCommand('copy'); ta.remove();
    }
    function flashBtn(btn,msg){
      const orig=btn.textContent; const origBg=btn.style.background;
      btn.textContent=msg; btn.style.background='#28a745';
      setTimeout(()=>{btn.textContent=orig; btn.style.background=origBg||'#6c757d';},1500);
    }

    // Auto-format CC
    function wireCardFormatters(){
      const cardInput = document.getElementById('cc-number');
      const expInput  = document.getElementById('cc-exp');
      const cvvInput  = document.getElementById('cc-cvv');
      if(cardInput){
        cardInput.addEventListener('input', e=>{
          let v=e.target.value.replace(/\s/g,'').replace(/\D/g,'').slice(0,16);
          e.target.value=v.replace(/(.{4})/g,'$1 ').trim();
        });
      }
      if(expInput){
        expInput.addEventListener('input', e=>{
          let v=e.target.value.replace(/\D/g,'').slice(0,4);
          if(v.length>=3) v=v.slice(0,2)+'/'+v.slice(2);
          e.target.value=v;
        });
      }
      if(cvvInput){
        cvvInput.addEventListener('input', e=>{
          e.target.value=e.target.value.replace(/\D/g,'').slice(0,3);
        });
      }
    }

    function focusFirstInput(id){
      if(id==='2'){
        const el=document.getElementById('cc-number');
        if(el && getComputedStyle(document.getElementById('card-form')).display!=='none') el.focus();
      }
      if(id==='3a'){
        const el=document.querySelector('#screen3a .otp-input'); if(el) el.focus();
      }
    }

    // Hover micro-effect
    function wireHoverButtons(){
      document.querySelectorAll('.btn-primary,.btn-secondary,.copy-btn').forEach(b=>{
        b.addEventListener('mouseenter',function(){this.style.transform='translateY(-2px)';this.style.transition='all .2s ease';});
        b.addEventListener('mouseleave',function(){this.style.transform='translateY(0)';});
      });
    }

    document.addEventListener('DOMContentLoaded',()=>{
      updateBackButton();
      updatePaymentMethod();
      wireCardFormatters();
      wireOtp();
      wireHoverButtons();

      // Ações iniciais da tela 1
      document.getElementById('toPay').addEventListener('click',()=>showScreen('2'));
    });
  
  </script>
</body>
</html>
